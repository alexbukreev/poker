import{j as e}from"./radix-B75hQdol.js";import{a as x}from"./icons-DkXWkkX2.js";import{c as w,u as L,S as P,B as p}from"./index-CQXbojvq.js";import{R as A,L as B,C as E,X as O,Y as R,T,a as z}from"./recharts-C8WVvDtN.js";function D(o,r){const s=r>0?o/r:0;return Math.round(s/(1+s)*1e3)/10}function Y(o){const r=w(o),s=o.heroSeat,c=o.contribs[s]??0,u=Math.max(0,...Object.values(o.contribs).map(n=>n??0)),l=Math.max(0,u-c),h=D(l,r);return{potBefore:r,toCall:l,threshold:h,heroSeat:s}}function N(o){const r=Math.round(o*10)/10;return Math.abs(r-Math.round(r))<1e-9?String(Math.round(r)):r.toFixed(1)}function G({state:o,onNewSpot:r}){const s=x.useMemo(()=>Y(o),[o]),[c,u]=x.useState(0),[l,h]=x.useState(null),[n,g]=x.useState([]),{errorTol:m}=L();x.useEffect(()=>{u(0),h(null)},[s.potBefore,s.toCall,s.heroSeat]);function C(){const t=Math.round(s.threshold*10)/10,a=Math.abs(c-t);h({correct:t,error:a}),g(i=>[...i,Number(a.toFixed(1))])}const b=l?l.error<=m:!1,y=t=>{const{cx:a,cy:i,value:d,payload:f}=t,j=(typeof d=="number"?d:f?.err)<=m;return e.jsx("circle",{cx:a,cy:i,r:2.5,className:j?"fill-green-500":"fill-red-500"})},M=t=>{const{cx:a,cy:i,value:d,payload:f}=t,j=(typeof d=="number"?d:f?.err)<=m;return e.jsx("circle",{cx:a,cy:i,r:3.5,className:j?"fill-green-500":"fill-red-500"})},v=n.length>0?n.reduce((t,a)=>t+a,0)/n.length:0,k=n.length>0?Math.min(...n):null,S=n.map((t,a)=>({i:a+1,err:t}));return e.jsxs("div",{className:"space-y-3 select-none",children:[e.jsxs("div",{className:"text-sm text-foreground/80",children:["Pot (before decision): ",e.jsx("b",{children:N(s.potBefore)})," • To call: ",e.jsx("b",{children:N(s.toCall)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm text-foreground/80",children:[e.jsx("span",{children:"Your answer"}),e.jsxs("span",{className:"text-foreground font-semibold",children:[c.toFixed(1),"%"]})]}),e.jsx(P,{value:[c],min:0,max:100,step:.1,onValueChange:t=>u(t[0]??c),className:"w-full","aria-label":"Your pot-odds answer in percent"})]}),e.jsxs("div",{className:"pt-1 flex items-center gap-2",children:[e.jsx(p,{variant:"outline",onClick:C,children:"Check"}),e.jsx(p,{variant:"outline",onClick:r,children:"New spot"})]}),l&&e.jsxs("div",{className:"mt-3 text-sm",children:["Correct: ",e.jsxs("b",{children:[l.correct.toFixed(1),"%"]})," • Error:"," ",e.jsxs("b",{className:b?"text-green-500":"text-red-500",children:[l.error.toFixed(1),"%"]}),b?" ✓":" ✗"]}),n.length>0&&e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"text-xs text-foreground/70",children:["Attempts: ",e.jsx("b",{className:"text-foreground",children:n.length})," • ","Avg error:"," ",e.jsxs("b",{className:v<=.5?"text-green-500":"text-foreground",children:[v.toFixed(1),"%"]}),k!==null&&e.jsxs(e.Fragment,{children:[" • ","Best: ",e.jsxs("b",{className:"text-foreground",children:[k.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"h-36 text-foreground",children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(B,{data:S,margin:{left:40,right:5,top:0,bottom:-10},children:[e.jsx(E,{stroke:"hsl(var(--border))",strokeOpacity:.4,vertical:!1}),e.jsx(O,{dataKey:"i",tickLine:!1,axisLine:!1,tickMargin:0,tick:{fontSize:10,fill:"currentColor"}}),e.jsx(R,{domain:[0,"dataMax + 1"],tickLine:!1,axisLine:!1,mirror:!0,width:1,tickMargin:-40,tick:{fontSize:10,fill:"currentColor"}}),e.jsx(T,{contentStyle:{background:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:8,color:"hsl(var(--foreground))"},formatter:t=>[`${t}%`,"Error"],labelFormatter:t=>`Attempt ${t}`}),e.jsx(z,{type:"monotone",dataKey:"err",stroke:"hsl(var(--foreground))",strokeWidth:2,dot:e.jsx(y,{}),activeDot:e.jsx(M,{})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>g([]),children:"Reset session"})})]})]})}export{G as default};
